

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Creating a napari plugin &#8212; Open Image Data Handbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/napari/make_a_simple_plugin';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Introduction to napari plugins" href="../napari_plugins/napari_plugin_tutorial_intro.html" />
    <link rel="prev" title="Downloading and launching the notebooks" href="napari_notebook_setup.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to the Open Image Data Handbook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tutorials_intro.html">Tutorials introduction</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../em/em_tutorial_intro.html">EM analysis tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../em/em_installation.html">Setting up your python environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../em/notebook_setup.html">Downloading and launching the notebooks</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="napari_tutorial_intro.html">Introduction to napari</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="napari_installation.html">Setting up your python environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="napari_notebook_setup.html">Downloading and launching the notebooks</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Creating a napari plugin</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../napari_plugins/napari_plugin_tutorial_intro.html">Introduction to napari plugins</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../napari_plugins/napari_plugin_installation.html">Setting up your python environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../napari_plugins/napari_plugin_notebook_setup.html">Downloading and launching the notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../napari_plugins/make_a_simple_plugin.html">Creating a napari plugin</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../neubias_plugins/neubias_plugin_tutorial_intro.html">NEUBIAS napari workshop</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../neubias_plugins/neubias_plugin_installation.html">Setting up your python environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../neubias_plugins/neubias_plugin_notebook_setup.html">Downloading and launching the notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../neubias_plugins/make_a_simple_plugin.html">Creating a napari plugin</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Explanations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../explanations/explanations_intro.html">Explanations introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../explanations/open_research_data/open_research_data_intro.html">Open Research Data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">How-tos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../how_tos/how_tos_introduction.html">How-tos introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_tos/install_python.html">Install python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_tos/conda_forge_packaging.html">Making your package available on conda-forge</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kevinyamauchi/Open Image Data Handbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kevinyamauchi/Open Image Data Handbook/issues/new?title=Issue%20on%20page%20%2Ftutorials/napari/make_a_simple_plugin.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/tutorials/napari/make_a_simple_plugin.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Creating a napari plugin</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-contribution">Choosing a contribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-cookiecutter-template-to-create-your-plugin-directory">Using the cookiecutter template to create your plugin directory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-a-function-gui">Implementing a function GUI</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-py-solution">_function.py solution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-the-other-files-generated-by-cookiecutter">Explore the other files generated by cookiecutter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-installing-your-plugin">Testing/Installing your plugin</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-exercises">Bonus exercises</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="creating-a-napari-plugin">
<h1>Creating a napari plugin<a class="headerlink" href="#creating-a-napari-plugin" title="Permalink to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<p>In this tutorial, we will make a napari analysis plugin from the <code class="docutils literal notranslate"><span class="pre">detect_spots()</span></code> function we wrote in the first part of this practical session. The primary steps in making a napari plugin are as follows:</p>
<ol class="arabic simple">
<li><p>choose which manifest contribution(s) your plugin requires</p></li>
<li><p>create your repository using the napari cookiecutter template</p></li>
<li><p>implement your contributions</p></li>
<li><p>share your plugin with the community</p></li>
</ol>
<p>In the following sections, we will work through steps (1) - (3). For step (4) you can refer to the <a class="reference external" href="https://www.youtube.com/watch?v=NL-VywidzXE">in depth plugin tutorial</a>,
or <a class="reference external" href="https://napari.org/plugins/test_deploy.html#preparing-for-release">the instructions on napari.org</a>.
You can also use <a class="reference external" href="https://docs.google.com/presentation/d/1-9ObrjrbjtrsO3kjEZELpd3QFDM0ct-oa3L-EIdO77I/edit?usp=sharing">the lecture slides</a> as reference material if you’d like.</p>
<p><img alt="plugin example" src="../../_images/plugin-01.png" /></p>
</section>
<section id="choosing-a-contribution">
<h2>Choosing a contribution<a class="headerlink" href="#choosing-a-contribution" title="Permalink to this heading">#</a></h2>
<p>A contribution is a construct in <code class="docutils literal notranslate"><span class="pre">napari.yaml</span></code> (the manifest file), that napari uses for each specific type of plugin. Each contribution conforms to a function signature, i.e. the function linked to the contribution defines what napari provides to the plugin (e.g., data and parameters) and what the plugin returns to napari. napari is then able to use the functions pointed to in <code class="docutils literal notranslate"><span class="pre">napari.yaml</span></code> to carry out the plugin tasks. The current categories of contributions are described below. Please see the <a class="reference external" href="https://napari.org/plugins/contributions.html">contribution reference</a> and <a class="reference external" href="https://napari.org/plugins/guides.html">contribution guide</a> for more details. Many plugins will declare multiple contributions to provide all of the desired functionality.</p>
<ul class="simple">
<li><p><strong>reader</strong>: allows loading of specified data formats into napari layers</p></li>
<li><p><strong>writer</strong>: this allows layer data to be written to disk in specified formats</p></li>
<li><p><strong>sample data</strong>: allows developers to provide users with sample data with their plugin.</p></li>
<li><p><strong>widget</strong>: allows custom Qt widgets (GUIs) to be added to napari, either from a <code class="docutils literal notranslate"><span class="pre">magic_factory</span></code> widget, a plain function, or a subclass of QWidget</p></li>
<li><p><strong>theme</strong>: allows customization of the entire napari viewer appearance e.g. light theme or dark theme</p></li>
</ul>
<p>In this tutorial, we will create a spot detection plugin by implementing a widget contribution with the spot detection function (<code class="docutils literal notranslate"><span class="pre">detect_spots()</span></code>) we created in the first part of this practical session.</p>
</section>
<section id="using-the-cookiecutter-template-to-create-your-plugin-directory">
<h2>Using the cookiecutter template to create your plugin directory<a class="headerlink" href="#using-the-cookiecutter-template-to-create-your-plugin-directory" title="Permalink to this heading">#</a></h2>
<p>To make creating plugins easier, we provide a template that automatically builds most of the infrastructure for your plugin, so you can focus on implementing the details unique to your plugin. The template is provided using a command line utility called <a class="reference external" href="https://github.com/cookiecutter/cookiecutter"><code class="docutils literal notranslate"><span class="pre">cookiecutter</span></code></a>. In the following steps, you will build your plugin directory using the cookiecutter template.</p>
<p>First, open your terminal and navigate to your Documents folder.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/Documents
</pre></div>
</div>
<p>Next, activate the conda environment you created in the first part of the tutorial. This environment includes all of the packages required to make your plugin (including <code class="docutils literal notranslate"><span class="pre">cookiecutter</span></code>).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>napari-tutorial
</pre></div>
</div>
<p>In this next step, we will use <code class="docutils literal notranslate"><span class="pre">cookiecutter</span></code> to create a directory for our plugin from the template. <code class="docutils literal notranslate"><span class="pre">cookiecutter</span></code> will ask a series of questions that that will customize the directory for your plugin. Once completed, a new directory will be created in your current directory. It will come pre-initialised with a git repository.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cookiecutter<span class="w"> </span>https://github.com/napari/cookiecutter-napari-plugin
</pre></div>
</div>
<p>You will be asked for some information to customize the setup of your plugin. Each prompt gives the default value in square brackets (<code class="docutils literal notranslate"><span class="pre">[]</span></code>). The questions are explained below. Enter your answer after the prompt and press enter to continue.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">full_name</span> <span class="pre">[Napari</span> <span class="pre">Developer]</span></code>: enter your name here. Names entered here will be listed as the authors of the plugin in the package metadata.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">email</span> <span class="pre">[yourname&#64;example.com]</span></code>: this email will be listed as the contact information in the package metadata</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">github_username_or_organization</span> <span class="pre">[githubuser]</span></code>: if you have a github username, you can enter it here. It will be used to generate a GitHub URL for you after you enter a plugin name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plugin_name</span> <span class="pre">[napari-foobar]</span></code>: enter the name you would like your plugin to be called. spaces are not allowed and are often replaced with <code class="docutils literal notranslate"><span class="pre">-</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">napari-spot-detector</span></code>). This will be your PyPI package name (if you choose to deploy your plugin).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Select</span> <span class="pre">github_repository_url:</span></code> this is used for plugin metadata and is not required now. If you don’t plan to upload it to your github, select 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">module_name</span> <span class="pre">[napari_foobar]</span></code>: this is the name of the module containing your plugin code. Typically, this is the plugin name with the <code class="docutils literal notranslate"><span class="pre">-</span></code> replaced with <code class="docutils literal notranslate"><span class="pre">_</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">napari_spot_detector</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">display_name</span> <span class="pre">[napari</span> <span class="pre">FooBar]</span></code>: this name will show up in the napari viewer and on the napari hub if you release your plugin. You should pick something human readable and ideally indicative of what your plugin does. There are no restrictions on the symbols in this name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">short_description</span> <span class="pre">[A</span> <span class="pre">simple</span> <span class="pre">plugin</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">with</span> <span class="pre">napari]</span></code>: give a one sentence description of your plugin. This will go into the readme.\</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include_reader_plugin</span> <span class="pre">[y]</span></code>: answer <code class="docutils literal notranslate"><span class="pre">y</span></code> (for yes) if you would like a reader contribution. We do not need a reader contribution for this tutorial, so answer <code class="docutils literal notranslate"><span class="pre">n</span></code> for no.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include_writer_plugin</span> <span class="pre">[y]</span></code>: answer <code class="docutils literal notranslate"><span class="pre">y</span></code> (for yes) if you would like a writer contribution. We do not need a writer contribution for this tutorial, so answer <code class="docutils literal notranslate"><span class="pre">n</span></code> for no.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include_sample_data_plugin</span> <span class="pre">[y]</span></code>: answer <code class="docutils literal notranslate"><span class="pre">y</span></code> (for yes) if you would like a sample data contribution. We do not need a sample data contribution for this tutorial, so answer <code class="docutils literal notranslate"><span class="pre">n</span></code> for no.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">include_dock_widget_plugin</span> <span class="pre">[y]</span></code>: answer <code class="docutils literal notranslate"><span class="pre">y</span></code> (for yes) if you would like a widget contribution. We are implementing a widget contribution for this tutorial, <strong>so answer <code class="docutils literal notranslate"><span class="pre">y</span></code> for yes</strong>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_git_tags_for_versioning</span> <span class="pre">[n]</span></code>: we will not be covering setting plugin versions in this tutorial, so enter <code class="docutils literal notranslate"><span class="pre">n</span></code> for no.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">install_precommit</span> <span class="pre">[n]</span></code>: we will not be covering precommit in this tutorial, so enter <code class="docutils literal notranslate"><span class="pre">n</span></code> for no.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Select</span> <span class="pre">license</span></code>: select the license you would like to use for your plugin. The license sets the rules for how others can build upon and re-use your plugin code. For more information on typical open source licenses, <a class="reference external" href="https://choosealicense.com/">choosealicense.com</a> is a good primer. The default choice is <a class="reference external" href="https://opensource.org/licenses/BSD-3-Clause">BSD-3</a>.</p></li>
</ul>
<p>After completing all of the questions, a directory will be created containing your new napari plugin. You will be given instructions on how to upload the initialized git repository to GitHub. By default, we will not be covering this aspect in the tutorial, but please feel free to ask the teaching team if you would like to give it a try. Your new plugin directory (assuming you called the plugin <code class="docutils literal notranslate"><span class="pre">napari-spot-detector</span></code> and the module <code class="docutils literal notranslate"><span class="pre">napari_spot_detector</span></code>) will be organized as follows (with some irrelevant files/folders omitted)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>napari-spot-detector
├── .github
│   └── workflows
│       └── test_and_deploy.yml
├── LICENSE
├── MANIFEST.in
├── .napari
│   └── DESCRIPTION.md
├── pyproject.toml
├── README.md
├── setup.cfg
├── src
│   └── napari_spot_detector
│       ├── __init__.py
│       ├── napari.yaml
│       ├── _tests
│       │   ├── __init__.py
│       │   └── test_widget.py
│       └── _widget.py
└── tox.ini
</pre></div>
</div>
<p>See below for explanations about some of the most notable files, but do not hesitate to reach out to the teaching team if you have questions about any of the other files.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.github/workflows/test_and_deploy.yml</span></code>: this is a <a class="reference external" href="https://github.com/features/actions">github actions</a> workflow that will automatically run the tests and upload your plugin to pypi (thus making it available through the built-in napari plugin browser. Please ask the teaching team if you would like to learn how to set up your github repository to support the workflow.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> and <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code>: these files allow your plugin to be built as a package and installed by pip. the cookiecutter template has set everything up in these files, so you are good to go!</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">src/</span></code> folder contains all the python code for your plugin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src/napari_spot_detector/_widget.py</span></code>: This file contains example implementations for different widget contributions. This is where you will add your <code class="docutils literal notranslate"><span class="pre">detect_spot()</span></code> function.</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">src/napari_spot_detector/napari.yaml</span></code> file declares commands and contributions for each example widget in the <code class="docutils literal notranslate"><span class="pre">_widget.py</span></code> file. Look at these carefully and match up which command &amp; contribution belong to what python code in the <code class="docutils literal notranslate"><span class="pre">_widget.py</span></code> file.</p></li>
</ul>
<p>You have now set up the directory for your new plugin! You can explore the directory and files with the file browser. In the next step, you will complete your plugin by adding your <code class="docutils literal notranslate"><span class="pre">detect_spots()</span></code> function to the <code class="docutils literal notranslate"><span class="pre">_widget.py</span></code> file.</p>
</section>
<section id="implementing-a-function-gui">
<h2>Implementing a function GUI<a class="headerlink" href="#implementing-a-function-gui" title="Permalink to this heading">#</a></h2>
<p>In this step, we will implement our <code class="docutils literal notranslate"><span class="pre">detect_spots()</span></code> function as a plugin contribution. First, we will add our spot detection function to the plugin package. Then, we will add the type annotations to the function to so that napari can infer the correct GUI elements to add to our plugin.</p>
<ol class="arabic">
<li><p>To edit your plugin source code, open an integrated development environment (VSCode is a good, free option) or text editor.</p></li>
<li><p>In VSCode, open the directory you created with <code class="docutils literal notranslate"><span class="pre">cookiecutter</span></code> in the section above.</p>
<ul class="simple">
<li><p>From the “File” menu, select “Open…”</p></li>
<li><p>Navigate to and select the directory you created with <code class="docutils literal notranslate"><span class="pre">cookiecutter</span></code> (<code class="docutils literal notranslate"><span class="pre">~/Documents/napari-spot-detector</span></code> if you called your plugin <code class="docutils literal notranslate"><span class="pre">napari-spot-detector)</span></code>.</p></li>
</ul>
</li>
<li><p>You should now see your plugin directory in the “Explorer” pane in the left hand side of the window. You can double click on folders to expand them and files to open them in the editor.</p></li>
<li><p>Open the <code class="docutils literal notranslate"><span class="pre">&lt;module_name&gt;/_widget.py</span></code> file using VSCode by double clicking on it in the “Explorer” pane.</p></li>
<li><p>You will see that it has already been populated with a few code blocks by cookiecutter.</p>
<ul class="simple">
<li><p>At the top, you see the imports. You can leave unchanged for now.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span>

<span class="kn">from</span> <span class="nn">magicgui</span> <span class="kn">import</span> <span class="n">magic_factory</span>
<span class="kn">from</span> <span class="nn">qtpy.QtWidgets</span> <span class="kn">import</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QWidget</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">napari</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Next, you see three different ways to add widgets to napari.</p>
<ol class="arabic simple">
<li><p>The first subclasses <code class="docutils literal notranslate"><span class="pre">QWidget</span></code> directly. This option provides
maximum flexibility, but means you have to take care of adding all the different GUI elements, laying them out, and hooking them
up to the viewer.</p></li>
</ol>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ExampleQWidget</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="c1"># your QWidget.__init__ can optionally request the napari viewer instance</span>
    <span class="c1"># in one of two ways:</span>
    <span class="c1"># 1. use a parameter called `napari_viewer`, as done here</span>
    <span class="c1"># 2. use a type annotation of &#39;napari.viewer.Viewer&#39; for any parameter</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">napari_viewer</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewer</span> <span class="o">=</span> <span class="n">napari_viewer</span>

        <span class="n">btn</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&quot;Click me!&quot;</span><span class="p">)</span>
        <span class="n">btn</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_on_click</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">QHBoxLayout</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">btn</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;napari has&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viewer</span><span class="o">.</span><span class="n">layers</span><span class="p">),</span> <span class="s2">&quot;layers&quot;</span><span class="p">)</span>    
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 2. The second option is to write a `magic_factory` decorated function. You might recognize this from our `intensify` widget in the lecture. With minimal extra work you can configure options for your GUI elements, such as min and max values for integers, or choices for dropdown boxes. See the [magicgui configuration docs](https://napari.org/magicgui/usage/configuration.html) for details on what you can configure in the decorator.
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@magic_factory</span>
<span class="k">def</span> <span class="nf">example_magic_widget</span><span class="p">(</span><span class="n">img_layer</span><span class="p">:</span> <span class="s2">&quot;napari.layers.Image&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;you have selected </span><span class="si">{</span><span class="n">img_layer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span> 3. Finally, you see the what looks like just a plain function. We don&#39;t need complex GUI interactions for our plugin, and we don&#39;t want to have to lay out the GUI ourselves, so we will modify this to incorporate our `detect_spots` function.
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uses the `autogenerate: true` flag in the plugin manifest</span>
<span class="c1"># to indicate it should be wrapped as a magicgui to autogenerate</span>
<span class="c1"># a widget.</span>
<span class="k">def</span> <span class="nf">example_function_widget</span><span class="p">(</span><span class="n">img_layer</span><span class="p">:</span> <span class="s2">&quot;napari.layers.Image&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;you have selected </span><span class="si">{</span><span class="n">img_layer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Find the <code class="docutils literal notranslate"><span class="pre">Command</span></code> ID in <code class="docutils literal notranslate"><span class="pre">napari.yaml</span></code> that points to <code class="docutils literal notranslate"><span class="pre">example_function_widget</span></code>, and then find that <code class="docutils literal notranslate"><span class="pre">Command</span></code> ID in the
<code class="docutils literal notranslate"><span class="pre">Widgets</span></code> contribution section. Note that unlike the other <code class="docutils literal notranslate"><span class="pre">widget</span></code> contributions, this one includes <code class="docutils literal notranslate"><span class="pre">autogenerate:</span> <span class="pre">true</span></code>.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">napari-spot-detector.make_func_widget</span>
<span class="w">  </span><span class="nt">autogenerate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">display_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Example Function Widget</span>
</pre></div>
</div>
<ul class="simple">
<li><p>This means our function doesn’t need to know anything about magicgui. If we provide type annotations to the parameters,
the GUI widgets will be generated for us without even a decorator!</p></li>
<li><p>Let’s edit <code class="docutils literal notranslate"><span class="pre">example_function_widget</span></code> to do our spot detection.</p></li>
</ul>
</li>
<li><p>You can delete everything above <code class="docutils literal notranslate"><span class="pre">example_function_widget</span></code> in <code class="docutils literal notranslate"><span class="pre">_widget.py</span></code> if you want. If you do, make sure to delete the associated <code class="docutils literal notranslate"><span class="pre">Commands</span></code> and <code class="docutils literal notranslate"><span class="pre">Widget</span></code> contributions, and the imports in <code class="docutils literal notranslate"><span class="pre">napari_spot_detector/__init__.py</span></code>!</p></li>
<li><p>Copy the <code class="docutils literal notranslate"><span class="pre">gaussian_high_pass()</span></code> and <code class="docutils literal notranslate"><span class="pre">detect_spots()</span></code> functions from your notebook from the first part of the tutorial and paste it where the example functions were (the ones you deleted in the previous step).</p></li>
<li><p>Next, we need to modify <code class="docutils literal notranslate"><span class="pre">detect_spots()</span></code> to return the necessary layer data so that napari can create a new Points layer with our detected spots. If <code class="docutils literal notranslate"><span class="pre">detect_spots()</span></code> returns a <code class="docutils literal notranslate"><span class="pre">LayerDataTuple</span></code>, napari will add a new layer to the viewer using the data in the <code class="docutils literal notranslate"><span class="pre">LayerDataTuple</span></code>. For more information on the <code class="docutils literal notranslate"><span class="pre">LayerDataTuple</span></code> type, please see <a class="reference external" href="https://napari.org/plugins/guides.html#the-layerdata-tuple">the docs</a>.</p>
<ul class="simple">
<li><p>The layer data tuple should be: <code class="docutils literal notranslate"><span class="pre">(layer_data,</span> <span class="pre">layer_metadata,</span> <span class="pre">layer_type)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">layer_data</span></code>: the data to be displayed in the new layer (i.e., the points coordinates)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">layer_metadata</span></code>: the display options for the layer stored as a dictionary. Some options to consider: <code class="docutils literal notranslate"><span class="pre">symbol</span></code>, <code class="docutils literal notranslate"><span class="pre">size</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">layer_type</span></code>: the name of the layer type as a string (i.e., <code class="docutils literal notranslate"><span class="pre">'Points'</span></code>)</p></li>
</ul>
</li>
<li><p>Add type annotations to the function parameters (inputs). Napari (via <a class="reference external" href="https://napari.org/magicgui/">magicgui</a>) will infer the required GUI elements from the type annotations. We have to add annotations to both the parameters (i.e., inputs to the function) and the return type.</p></li>
<li><p>Annotate the Return type as <code class="docutils literal notranslate"><span class="pre">&quot;napari.types.LayerDataTuple&quot;</span></code>.</p></li>
<li><p>Add the required imports for the <code class="docutils literal notranslate"><span class="pre">scipy.ndimage</span></code> module and <code class="docutils literal notranslate"><span class="pre">scikit-image</span></code> <code class="docutils literal notranslate"><span class="pre">blob_log()</span></code> function to the top of the file.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">scipy</span> <span class="pre">import</span> <span class="pre">ndimage</span> <span class="pre">as</span> <span class="pre">ndi</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">skimage.feature</span> <span class="pre">import</span> <span class="pre">blob_log</span></code></p></li>
</ul>
</li>
</ol>
<section id="function-py-solution">
<h3>_function.py solution<a class="headerlink" href="#function-py-solution" title="Permalink to this heading">#</a></h3>
<p>See below for an example implementation of the <code class="docutils literal notranslate"><span class="pre">_widget.py</span></code> file, and the associated changes to <code class="docutils literal notranslate"><span class="pre">napari.yaml</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># _widget.py</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span>


<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">ndimage</span> <span class="k">as</span> <span class="n">ndi</span>
<span class="kn">from</span> <span class="nn">skimage.feature</span> <span class="kn">import</span> <span class="n">blob_log</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">napari</span>


<span class="k">def</span> <span class="nf">gaussian_high_pass</span><span class="p">(</span><span class="n">image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a gaussian high pass filter to an image.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    image : np.ndarray</span>
<span class="sd">        The image to be filtered.</span>
<span class="sd">    sigma : float</span>
<span class="sd">        The sigma (width) of the gaussian filter to be applied.</span>
<span class="sd">        The default value is 2.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    high_passed_im : np.ndarray</span>
<span class="sd">        The image with the high pass filter applied</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">low_pass</span> <span class="o">=</span> <span class="n">ndi</span><span class="o">.</span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
    <span class="n">high_passed_im</span> <span class="o">=</span> <span class="n">image</span> <span class="o">-</span> <span class="n">low_pass</span>

    <span class="k">return</span> <span class="n">high_passed_im</span>


<span class="k">def</span> <span class="nf">detect_spots</span><span class="p">(</span>
    <span class="n">image</span><span class="p">:</span> <span class="s2">&quot;napari.types.ImageData&quot;</span><span class="p">,</span>
    <span class="n">high_pass_sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">spot_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">blob_sigma</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;napari.types.LayerDataTuple&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a gaussian high pass filter to an image.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    image : napari.types.ImageData</span>
<span class="sd">        The image in which to detect the spots.</span>
<span class="sd">    high_pass_sigma : float</span>
<span class="sd">        The sigma (width) of the gaussian filter to be applied.</span>
<span class="sd">        The default value is 2.</span>
<span class="sd">    spot_threshold : float</span>
<span class="sd">        The threshold to be passed to the blob detector.</span>
<span class="sd">        The default value is 0.01.</span>
<span class="sd">    blob_sigma: float</span>
<span class="sd">        The expected sigma (width) of the spots. This parameter</span>
<span class="sd">        is passed to the &quot;max_sigma&quot; parameter of the blob</span>
<span class="sd">        detector.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    layer_data : napari.types.LayerDataTuple</span>
<span class="sd">        The layer data tuple to create a points layer</span>
<span class="sd">        with the spot coordinates.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># filter the image</span>
    <span class="n">filtered_spots</span> <span class="o">=</span> <span class="n">gaussian_high_pass</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">high_pass_sigma</span><span class="p">)</span>

    <span class="c1"># detect the spots</span>
    <span class="n">blobs_log</span> <span class="o">=</span> <span class="n">blob_log</span><span class="p">(</span>
        <span class="n">filtered_spots</span><span class="p">,</span>
        <span class="n">max_sigma</span><span class="o">=</span><span class="n">blob_sigma</span><span class="p">,</span>
        <span class="n">num_sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">threshold</span><span class="o">=</span><span class="n">spot_threshold</span>
    <span class="p">)</span>
    <span class="n">points_coords</span> <span class="o">=</span> <span class="n">blobs_log</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">sizes</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">blobs_log</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>

    <span class="n">layer_data</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">points_coords</span><span class="p">,</span>
        <span class="p">{</span>
            <span class="s2">&quot;face_color&quot;</span><span class="p">:</span> <span class="s2">&quot;magenta&quot;</span><span class="p">,</span>
            <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">sizes</span>
        <span class="p">},</span>
        <span class="s2">&quot;Points&quot;</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">layer_data</span>

</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># napari_spot_detector/__init__.py</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;0.0.1&quot;</span>
</pre></div>
</div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1">#napari.yaml</span>
<span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">napari-spot-detector</span>
<span class="nt">display_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Spot Detection</span>
<span class="nt">contributions</span><span class="p">:</span>
<span class="w">  </span><span class="nt">commands</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">napari-spot-detector.make_func_widget</span>
<span class="w">      </span><span class="nt">python_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">napari_spot_detector._widget:detect_spots</span>
<span class="w">      </span><span class="nt">title</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Make spot detection widget</span>
<span class="w">  </span><span class="nt">widgets</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">napari-spot-detector.make_func_widget</span>
<span class="w">      </span><span class="nt">autogenerate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">      </span><span class="nt">display_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Spot Detection</span>
</pre></div>
</div>
</section>
</section>
<section id="explore-the-other-files-generated-by-cookiecutter">
<h2>Explore the other files generated by cookiecutter<a class="headerlink" href="#explore-the-other-files-generated-by-cookiecutter" title="Permalink to this heading">#</a></h2>
<p>In order for napari to automatically find and make your plugin available to the user once it has been installed (i.e., “discoverable”), we must add a <code class="docutils literal notranslate"><span class="pre">napari.manifest</span></code> entry point to the <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> file. An entry point is a way that a python package can advertise that it has a component available (our plugin in this case). napari searches the python environment for packages that have a <code class="docutils literal notranslate"><span class="pre">napari.manifest</span></code> and then uses the path in the <code class="docutils literal notranslate"><span class="pre">entry_point</span></code> to find <code class="docutils literal notranslate"><span class="pre">napari.yaml</span></code>, where all your
plugin functionality is declared.</p>
<p>If we open the <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> file created by <code class="docutils literal notranslate"><span class="pre">cookiecutter</span></code>, we see that the entry point was already added by the cookiecutter template! If you called your plugin <code class="docutils literal notranslate"><span class="pre">napari-spot-detector</span></code> and your module <code class="docutils literal notranslate"><span class="pre">napari_spot_detector</span></code>, you will see the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">options</span><span class="o">.</span><span class="n">entry_points</span><span class="p">]</span>
<span class="n">napari</span><span class="o">.</span><span class="n">manifest</span> <span class="o">=</span>
    <span class="n">napari</span><span class="o">-</span><span class="n">spot</span><span class="o">-</span><span class="n">detector</span> <span class="o">=</span> <span class="n">napari_spot_detector</span><span class="p">:</span><span class="n">napari</span><span class="o">.</span><span class="n">yaml</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">src</span></code> doesn’t occur in the path to <code class="docutils literal notranslate"><span class="pre">napari.yaml</span></code>, but <code class="docutils literal notranslate"><span class="pre">napari.yaml</span></code> is definitely within the <code class="docutils literal notranslate"><span class="pre">src</span></code> folder! Python knows
to look inside the <code class="docutils literal notranslate"><span class="pre">src</span></code> folder for your code because <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> declares an <code class="docutils literal notranslate"><span class="pre">options.packages.find</span></code> key.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">options</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">find</span><span class="p">]</span>
<span class="n">where</span> <span class="o">=</span> <span class="n">src</span>
</pre></div>
</div>
</section>
<section id="testing-installing-your-plugin">
<h2>Testing/Installing your plugin<a class="headerlink" href="#testing-installing-your-plugin" title="Permalink to this heading">#</a></h2>
<p>To test and use our plugin, we need to install it in our python environment. First, return to your terminal and verify you have the <code class="docutils literal notranslate"><span class="pre">napari-tutorial</span></code> environment activated. Then, navigate to the directory that you created with the cookiecutter. For example, if you named your plugin <code class="docutils literal notranslate"><span class="pre">napari-spot-detector</span></code>, you would enter the following into your terminal.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~/Documents/napari-spot-detector
</pre></div>
</div>
<p>Then, we install the plugin with pip. pip is the package installer for python (see <a class="reference external" href="https://pip.pypa.io/en/stable/">the documentation</a> for more information). We will use the <code class="docutils literal notranslate"><span class="pre">-e</span></code> option to install in “editable” mode. This means that when we make a change to our source code, it will update the installed package the next time it is imported, without us having to reinstall it.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
<p>To confirm if your installation completed successfully, you can launch napari from the command line.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>napari
</pre></div>
</div>
<p>Once napari is open, you can open your plugin from the “Plugin” menu. You can test your plugin by locating the spots image from the tutorial notebooks folder (<code class="docutils literal notranslate"><span class="pre">napari_plugin_intro_workshop</span></code>) we downloaded at the beginning of this tutorial in the File browser (<code class="docutils literal notranslate"><span class="pre">&lt;path</span> <span class="pre">to</span> <span class="pre">notebook</span> <span class="pre">folder&gt;/data/spots_cropped.tif</span></code>), dragging the image into the napari viewer, and try running the plugin.</p>
<p>Congratulations! You have made your first napari plugin!</p>
</section>
<section id="bonus-exercises">
<h2>Bonus exercises<a class="headerlink" href="#bonus-exercises" title="Permalink to this heading">#</a></h2>
<p>In case you have finished all of the exercises with some time to spare, we have provided some ideas for ways that you can extend the plugin. Please feel free to give them a go and ask the teaching team if you have any questions.</p>
<ul class="simple">
<li><p>add sample data to your plugin. To do so, you would need to implement the <a class="reference external" href="https://napari.org/plugins/guides.html#sample-data">sample data contribution</a></p></li>
<li><p>add an option to your <code class="docutils literal notranslate"><span class="pre">detect_spots()</span></code> function plugin to return the filtered image in addition to the points layer.</p></li>
<li><p>add some tests to the <code class="docutils literal notranslate"><span class="pre">_tests/test_widget.py</span></code> file.</p></li>
<li><p>upload your plugin to github</p></li>
<li><p>start your own plugin</p></li>
<li><p>consult with the teaching team about integrating napari into your workflow</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./tutorials/napari"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="napari_notebook_setup.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Downloading and launching the notebooks</p>
      </div>
    </a>
    <a class="right-next"
       href="../napari_plugins/napari_plugin_tutorial_intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Introduction to napari plugins</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#choosing-a-contribution">Choosing a contribution</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-the-cookiecutter-template-to-create-your-plugin-directory">Using the cookiecutter template to create your plugin directory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementing-a-function-gui">Implementing a function GUI</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#function-py-solution">_function.py solution</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explore-the-other-files-generated-by-cookiecutter">Explore the other files generated by cookiecutter</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#testing-installing-your-plugin">Testing/Installing your plugin</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-exercises">Bonus exercises</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kevin Yamauchi
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>